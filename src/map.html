<!DOCTYPE html>
<html lang="ko">

<head>
    {{>meta}}
    
    <script type="module" src="/js/common/ui.js"></script>
    <script type="module" src="/js/pages/map.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v7.4.0/ol.css">
</head>

<body>
    <div id="wrap" class="map-page">
        <div class="map-header">
            
        </div>
        <main class="map-main">
            <!-- left panel -->
            
            {{> map-aside}}
            <!-- // left panel -->

            <!-- right content -->
            {{> map-detail-panel}}
            <!-- // right content -->

            <div class="map-area">
                <div id="map"></div>
                
                <div class="map-topleft">
                    <div class="map-condition-select">
                        <select name="" id="" title="무인도서 관리유형 선택">
                            <option value="">무인도서 관리유형</option>
                        </select>
                        <select name="" id="" title="주변해역 관리유형 선택">
                            <option value="">주변해역 관리유형</option>
                        </select>
                        <select name="" id="" title="소유구분 선택">
                            <option value="">소유구분</option>
                        </select>
                        <select name="" id="" title="무인도서 면적 선택">
                            <option value="">무인도서 면적</option>
                        </select>
                    </div>
                </div>

                <div class="map-topright">
                    <div class="map-control-panel">
                        {{> map-control-btn}}
                        {{> map-zoom-control}}
                    </div>
                </div>

                <div class="map-bottomleft">
                    {{> map-minimap}}
                </div>

                <div class="map-bottomcenter">
                    <div class="map-location-search">
                        <button type="button" class="btn-search toggle-btn" title="지도에서 검색" aria-pressed="false">지도에서 검색<i class="svg-icon ico-search"></i></button>
                        <select name="" id="" title="시도 선택">
                            <option value="">광역시도 전체</option>
                        </select>
                        <select name="" id="" title="시군구 선택">
                            <option value="">시군구 전체</option>
                        </select>
                    </div>
                </div>
                
                <div class="map-bottomright">
                    {{> map-legend}}
                    {{> map-scale-box}}
                </div>
            </div>
            <!-- // map-area -->

            {{> map-info-tool}}
            
            {{> map-context-menu}}

            {{> map-pin-popup}}
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/ol@v7.4.0/dist/ol.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const headerViewtime = 3000;
            const headerVariable = false;
            // 초기 header 보임 후 숨김
            if(headerVariable){
                document.body.classList.add('header-v');
                setTimeout(() => {
                    document.body.classList.remove('header-v');
                }, headerViewtime);
            }

            // 미니맵
            const btnMinimap = document.querySelector('.btn-minimap');
            const miniMapMain = document.querySelector('.mini-map-main');

            if(btnMinimap && miniMapMain) {
                btnMinimap.addEventListener('click', () => {
                    miniMapMain.classList.toggle('active');
                    btnMinimap.classList.toggle('active')
                    btnMinimap.setAttribute('title', miniMapMain.classList.contains('active') ? '미니맵 확대' : '미니맵 축소');
                });
            }

            // OpenLayers 지도 세팅 (CDN)
            if(document.getElementById('map')) {
                const map = new ol.Map({
                    target: 'map',
                    controls: ol.control.defaults.defaults({
                        zoom: false
                    }),
                    layers: [
                        new ol.layer.Tile({
                            source: new ol.source.OSM()
                        })
                    ],
                    view: new ol.View({
                        center: ol.proj.fromLonLat([127.7669, 35.9078]), // 대한민국 중심 좌표
                        zoom: 7
                    })
                });
                
            }
        })
    </script>

    <script>
    // 접근성 고려 탭 스크립트
    (function(){
        var panelTabs = document.querySelectorAll('.panel-tab');
        var panelTabContents = document.querySelectorAll('.panel-tab-content');
        panelTabs.forEach(function(btn, idx){
            btn.addEventListener('click', function(){
                panelTabs.forEach(function(b, i){
                    b.setAttribute('aria-selected', i === idx ? 'true' : 'false');
                    b.tabIndex = i === idx ? 0 : -1;
                });
                panelTabContents.forEach(function(content, i){
                    //content.style.display = i === idx ? '' : 'none';
                    content.classList.toggle('active', i === idx);
                });
            });
        });
    })();

    const toggleBtn = document.querySelectorAll('.toggle-btn');
    toggleBtn.forEach(btn => {
        btn.addEventListener('click', () => {
            btn.setAttribute('aria-pressed', btn.getAttribute('aria-pressed') === 'true' ? 'false' : 'true');
        });
    });

    </script>
</body>

</html>